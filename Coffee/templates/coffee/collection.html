{% extends 'coffee/header.html' %}
{% block content %}
  <script>
    function deleteClick(id) {
      var confirmed = confirm('Are you sure you want to delete this coffee?');
      if (confirmed) {
        var token = Cookies.get('csrftoken');
        $.ajax(
          {
            headers: { 'X-CSRFToken': token },
            url: 'http://localhost:8000/delete/' + id,
            type: 'DELETE',
            success: function(res) {
              console.log(res);
              return window.location.reload();
            },
            error: function(err) {
              console.log(err);
            }
          }
        );
      } else { console.log('noooo') }
    }
  </script>

  <div class="row">
    {% csrf_token %}
    {% for coffee in all_coffee %}
      <div class="col s12 m6 l4">
        <div class="card blue-grey darken-1">
          <div class="card-content white-text">
            <span class="card-title">{{ coffee.name }}</span>
            <p style="font-size: 70%;">{{ coffee.roaster }}</p>
            <p>{{ coffee.brew_method }}</p>
            <p>{{ coffee.variety }}</p>
            <p>{{ coffee.tasting_notes }}</p>
          </div>
          <div class="card-action">
            <a href="edit/{{coffee.id}}" id="{{coffee.id}}">Edit</a>
            <button onclick="deleteClick('{{ coffee.id }}')">del</button>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}
